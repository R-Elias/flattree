# FLATTREE(1) — User Commands

## NAME

**flattree** — flatten or rebuild a directory tree with file contents.

A lightweight command-line tool to *flatten* a directory into a single text file (for code analysis, backup, or sharing),
or *rebuild* a directory tree from that flat file.

---

## SYNOPSIS

**Read mode (flatten a directory):**

```
python flattree.py read [-o OUTPUT_FILE] [-d DIRECTORY]
                        [--extensions=EXT1,EXT2]
                        [--strict-extensions=EXT1,EXT2]
                        [-n MAX_LINES]
                        [--ignore=IGNORE1,IGNORE2]
```

**Write mode (rebuild a directory):**

```
python flattree.py write -i INPUT_FILE [-d OUTPUT_DIRECTORY]
```

---

## DESCRIPTION

`flattree` works in **two completely distinct modes**:

### • READ mode

Traverses a directory and generates a *flat* text representation of its structure and selected file contents.

Each entry is separated by a unique separator line:

```
*----flattree-file-separator----*
```

This mode is useful for:

* Sending entire codebases to LLMs or diff tools.
* Backing up small projects into a single file.
* Comparing or documenting directory structures.

### • WRITE mode

Reads a file previously generated by `flattree` and **rebuilds the full directory tree**, recreating directories and writing files with their original content.

If existing files are present, they are overwritten.
(You can easily add logic later to back up or skip them.)

---

## OPTIONS

### General

* `read` or `write`
  Selects the operating mode.

* `-d DIRECTORY`, `--directory DIRECTORY`
  Target directory (for `read`) or destination directory (for `write`).
  Defaults to the current working directory.

### Read mode only

* `-o OUTPUT_FILE`, `--output OUTPUT_FILE`
  Output file name. If omitted, prints to standard output.

* `--extensions=EXT1,EXT2,...`
  Only include file contents for the listed extensions (e.g. `py,js,css`).

* `--strict-extensions=EXT1,EXT2,...`
  Include contents only for exact extensions (e.g. `--strict-extensions=js` includes `file.js` but not `file.spec.js`).

* `-n MAX_LINES`, `--max-lines MAX_LINES`
  Include file contents only if the file has *≤ MAX_LINES* lines.

* `--ignore=IGNORE1,IGNORE2,...`
  Comma-separated list of directories or files to ignore (e.g. `node_modules,build,bin`).
  A `.flattreeignore` file at the root of the project is also supported.

### Write mode only

* `-i INPUT_FILE`, `--input INPUT_FILE`
  Flat file produced by `flattree read`.

---

## FEATURES

* **Pruning**: ignored directories (e.g. `bin`, `node_modules`) are skipped entirely during traversal.
* **Automatic output exclusion**: if your output file is inside the analyzed directory, it is ignored automatically.
* **Improved UX**:

  * Clear error messages if directories or files are missing.
  * Summary printed at the end:
    `"NN files listed, MM files with content included."`
* **Two clear modes (`read` / `write`)** for simplicity.

---

## EXAMPLES

### Flatten a directory

```
python flattree.py read -d ./my_project -o my_project.flat
```

### Include only certain extensions

```
python flattree.py read -d ./app --extensions=py,js -o app.flat
```

### Skip large files (>100 lines)

```
python flattree.py read -d ./src -n 100 -o src_small.flat
```

### Ignore build artifacts

```
python flattree.py read -d ./ -o repo.flat --ignore=node_modules,build,bin
```

### Rebuild a project from a flat file

```
python flattree.py write -i my_project.flat -d ./reconstructed_project
```

---

## FILE FORMAT

Each entry in a flat file begins with the separator line:

```
*----flattree-file-separator----*
```

Followed by a path (directory ending with `/`, or a file path).
If it’s a file, its content appears on the following lines until the next separator.

Example:

```
*----flattree-file-separator----*
src/
*----flattree-file-separator----*
src/main.py
print("Hello, world!")
*----flattree-file-separator----*
README.md
# Example project
```

---

## NOTES

* All operations use UTF-8 encoding.
* Files that cannot be decoded are skipped with a warning.
* The separator string can be changed in the code by editing `DEFAULT_SEPARATOR`.
* `flattree` does **not** preserve metadata (permissions, timestamps, etc.).
* Works on Windows, macOS, and Linux (Python ≥ 3.8).

---

## AUTHOR

Elias Aliche
[https://github.com/R-Elias](https://github.com/R-Elias)

